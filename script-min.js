const CONFIG={YT_API_KEY:"AIzaSyDzpoppFO0ONZ9EL3ZKwbqK_qzTFj54lAY",YT_CHANNEL_ID:"UC_nCdtD-j7nDD1rMsf3LK-w",TELEGRAM_BOT_TOKEN:"8168097002:AAET9zUUlA-Cr7GGI1cAvWEk_R0IpJPVWfo",TELEGRAM_CHAT_ID:"@dekutconnect",SOCIALS:{youtube:"https://www.youtube.com/@DEKUTCONNECT",tiktok:"https://www.tiktok.com/@dekutconnect.official",instagram:"https://www.instagram.com/dekutconnect",snapchat:"https://www.snapchat.com",telegram:"https://t.me/DEKUTCONNECT",whatsappChannel:"https://www.whatsapp.com/channel/0029VbAb8L46WaKx34k8vU0S"}},el=t=>document.querySelector(t),elAll=t=>document.querySelectorAll(t);function handleGroupModalFromUrl(){const t=new URLSearchParams(window.location.search),e=window.location.hash,n=["showGroups","groups","whatsapp","join","modal"];for(const e of n)if("true"===t.get(e)||"groups"===t.get(e))return openGroupsModal(),!0;return("#groups"===e||"#whatsapp"===e||"#join"===e)&&(openGroupsModal(),!0)}function setupAppInstall(){const t=el("#appInstallBanner"),e=el("#appInstallPopup"),n=el("#bannerInstallBtn"),o=el("#bannerCloseBtn"),a=el("#popupInstallBtn"),s=el("#popupCloseBtn"),l=el("#popupLaterBtn"),i=localStorage.getItem("dekutconnect_banner_dismissed"),c=localStorage.getItem("dekutconnect_popup_dismissed");function d(){e.classList.remove("active"),localStorage.setItem("dekutconnect_popup_dismissed","true")}function r(){if(/Android/i.test(navigator.userAgent)){const t=document.createElement("iframe");t.style.display="none",t.src="https://play.google.com/store/apps/details?id=com.eduniapps.dkut&hl=en",document.body.appendChild(t),function(){const t=document.createElement("div");t.style.cssText="\n        position: fixed;\n        bottom: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background: var(--dekut-green);\n        color: #051014;\n        padding: 12px 20px;\n        border-radius: var(--border-radius);\n        font-weight: 600;\n        z-index: 1003;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.3);\n      ",t.textContent="App installation started!",document.body.appendChild(t),setTimeout((()=>{document.body.removeChild(t)}),3e3)}()}else/iPhone|iPad|iPod/i.test(navigator.userAgent)?window.open("https://apps.apple.com/app/idYOUR_APP_ID_HERE","_blank"):window.open("https://dkutapp-eduniapps.web.app","_blank")}i||t.classList.remove("hidden"),n.addEventListener("click",(()=>{r()})),o.addEventListener("click",(()=>{t.classList.add("hidden"),localStorage.setItem("dekutconnect_banner_dismissed","true")})),a.addEventListener("click",(()=>{r(),d()})),s.addEventListener("click",(()=>{d()})),l.addEventListener("click",(()=>{d()})),c||setTimeout((()=>{e.classList.add("active")}),5e3)}function openGroupsModal(){setTimeout((()=>{const t=el("#waGroupsModal");t&&(t.style.display="flex",t.style.animation="pulse 2s ease-in-out",setTimeout((()=>{t.style.animation=""}),2e3))}),1e3)}function setupBottomSheets(){const t=el("#donateBtn"),e=el("#shopBtn"),n=el("#totalCommunityBtn"),o=el("#sheetOverlay");t?.addEventListener("click",(()=>openSheet("donateSheet"))),e?.addEventListener("click",(()=>openSheet("shopSheet"))),n?.addEventListener("click",(()=>openSheet("totalCommunitySheet"))),o?.addEventListener("click",closeAllSheets),elAll(".sheet-close").forEach((t=>{t.addEventListener("click",(()=>closeSheet(t.dataset.sheet)))}))}function openSheet(t){closeAllSheets(),el("#"+t)?.classList.add("active"),el("#sheetOverlay")?.classList.add("active")}function closeSheet(t){el("#"+t)?.classList.remove("active"),el("#sheetOverlay")?.classList.remove("active")}function closeAllSheets(){elAll(".bottom-sheet").forEach((t=>t.classList.remove("active"))),el("#sheetOverlay")?.classList.remove("active")}function setupModals(){const t=el("#contactBtn"),e=el("#contactModal"),n=el('[data-modal="contactModal"]');t?.addEventListener("click",(()=>e.style.display="flex")),n?.addEventListener("click",(()=>e.style.display="none")),e?.addEventListener("click",(t=>{t.target===e&&(e.style.display="none")}));const o=el("#whatsappGroupsBtn"),a=el("#waGroupsModal"),s=el('[data-modal="waGroupsModal"]');o?.addEventListener("click",(()=>{a.style.display="flex"})),s?.addEventListener("click",(()=>{if(a.style.display="none",window.history.replaceState){const t=window.location.pathname;window.history.replaceState({},document.title,t)}})),a?.addEventListener("click",(t=>{if(t.target===a&&(a.style.display="none",window.history.replaceState)){const t=window.location.pathname;window.history.replaceState({},document.title,t)}}));const l=el("#advertiseBtn"),i=el("#advModal"),c=el("#advClose");l?.addEventListener("click",(()=>i.style.display="flex")),c?.addEventListener("click",(()=>i.style.display="none")),i?.addEventListener("click",(t=>{t.target===i&&(i.style.display="none")}));const d=el("#videoModal");el(".close")?.addEventListener("click",(()=>{d.style.display="none";const t=el("#videoPlayer");t&&(t.src="")})),d?.addEventListener("click",(t=>{if(t.target===d){d.style.display="none";const t=el("#videoPlayer");t&&(t.src="")}}))}const socialsMeta=[{key:"whatsapp-channel",name:"WhatsApp Channel",desc:"Followers",iconUrl:"https://cdn-icons-png.flaticon.com/512/1384/1384023.png"},{key:"tiktok",name:"TikTok",desc:"Followers",iconUrl:"https://cdn-icons-png.flaticon.com/512/3046/3046126.png"},{key:"youtube",name:"YouTube",desc:"Subscribers",iconUrl:"https://cdn-icons-png.flaticon.com/512/1384/1384028.png"},{key:"telegram",name:"Telegram",desc:"Members",iconUrl:"https://cdn-icons-png.flaticon.com/512/2111/2111646.png"}];function formatNum(t){return null==t?"--":"string"==typeof t?t:t>=1e9?(t/1e9).toFixed(1)+"B":t>=1e6?(t/1e6).toFixed(1)+"M":t>=1e3?(t/1e3).toFixed(1)+"K":t.toString()}function renderSocialTiles(t){const e=el("#socialGrid");e&&(e.innerHTML="",t.forEach((t=>{const n=document.createElement("div");n.className=`social social-${t.key} ${"--"===t.count?"loading":""}`,n.innerHTML=`\n        <div class="s-left"><img src="${t.iconUrl}" alt="${t.name}" loading="lazy"></div>\n        <div class="s-info">\n          <div class="s-name">${t.name}</div>\n          <div class="s-desc">${t.desc}</div>\n        </div>\n        <div class="count" id="count-${t.key}">${formatNum(t.count)}</div>\n      `,e.appendChild(n),"whatsapp-groups"===t.key?(n.style.cursor="pointer",n.addEventListener("click",(()=>el("#waGroupsModal").style.display="flex"))):"snapchat"===t.key?(n.style.cursor="pointer",n.addEventListener("click",(()=>window.open(CONFIG.SOCIALS.snapchat,"_blank")))):t.key in CONFIG.SOCIALS&&(n.style.cursor="pointer",n.addEventListener("click",(()=>window.open(CONFIG.SOCIALS[t.key],"_blank"))))})))}function updateTotalCountRandom(){const t=Math.floor(201*Math.random())+32600,e=el("#totalCount");e&&(e.textContent=t.toLocaleString())}async function fetchWhatsAppChannelCount(){try{const t=await fetch(`https://api.giftedtech.web.id/api/stalk/wachannel?apikey=gifted&url=${encodeURIComponent(CONFIG.SOCIALS.whatsappChannel)}`);return(await t.json())?.result?.followers??"--"}catch(t){return"counting..."}}async function fetchYouTubeCount(){if(!CONFIG.YT_API_KEY||!CONFIG.YT_CHANNEL_ID)return null;try{const t=await fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${CONFIG.YT_CHANNEL_ID}&key=${CONFIG.YT_API_KEY}`);return(await t.json())?.items?.[0]?.statistics?.subscriberCount||null}catch(t){return null}}async function fetchTelegramCount(){if(!CONFIG.TELEGRAM_BOT_TOKEN||!CONFIG.TELEGRAM_CHAT_ID)return null;try{const t=await fetch(`https://api.telegram.org/bot${CONFIG.TELEGRAM_BOT_TOKEN}/getChatMembersCount?chat_id=${encodeURIComponent(CONFIG.TELEGRAM_CHAT_ID)}`);return(await t.json())?.result||null}catch(t){return null}}async function fetchInstagramCount(){try{const t=await fetch("https://api.giftedtech.web.id/api/stalk/igstalk?apikey=gifted&username=dekutconnect");return(await t.json())?.result?.followers??"counting"}catch(t){return"counting..."}}async function fetchTikTokCount(){try{const t=await fetch("https://api.giftedtech.web.id/api/stalk/tiktokstalk?apikey=gifted&username=dekutconnect.official");return(await t.json())?.result?.followers??"--"}catch(t){return"--"}}async function updateWhatsAppChannel(){const t=await fetchWhatsAppChannelCount(),e=el("#count-whatsapp-channel");e&&(e.textContent=formatNum(t),e.classList.add("pulse"),updateTotalCountRandom());const n=el("#whatsappStatCount");n&&(n.textContent=formatNum(t))}async function updateInstagram(){const t=await fetchInstagramCount(),e=el("#count-instagram");e&&(e.textContent=formatNum(t),e.classList.add("pulse"),updateTotalCountRandom());const n=el("#instagramStatCount");n&&(n.textContent=formatNum(t))}async function updateTikTok(){const t=await fetchTikTokCount(),e=el("#count-tiktok");e&&(e.textContent=formatNum(t),e.classList.add("pulse"),updateTotalCountRandom());const n=el("#tiktokStatCount");n&&(n.textContent=formatNum(t))}async function updateYouTube(){const t=await fetchYouTubeCount(),e=el("#count-youtube");e&&null!==t&&(e.textContent=formatNum(t),e.classList.add("pulse"),updateTotalCountRandom());const n=el("#youtubeStatCount");n&&(n.textContent=formatNum(t))}async function updateTelegram(){const t=await fetchTelegramCount(),e=el("#count-telegram");e&&null!==t&&(e.textContent=formatNum(t),e.classList.add("pulse"),updateTotalCountRandom());const n=el("#telegramStatCount");n&&(n.textContent=formatNum(t))}async function updateAllCounts(){await Promise.all([updateYouTube(),updateTelegram(),updateInstagram(),updateTikTok(),updateWhatsAppChannel()])}renderSocialTiles(socialsMeta.map((t=>({...t,count:"--"})))),updateTotalCountRandom(),setInterval(updateTotalCountRandom,9e3),updateAllCounts();let nextPageToken=null;async function fetchYouTubeVideos(t=""){try{const e=await fetch(`https://www.googleapis.com/youtube/v3/search?key=${CONFIG.YT_API_KEY}&channelId=${CONFIG.YT_CHANNEL_ID}&part=snippet,id&order=date&maxResults=6&pageToken=${t}`),n=await e.json(),o=document.getElementById("youtube-section"),a=document.getElementById("youtube-feed");if(!o||!a)return;if(!n.items||0===n.items.length)return void(o.style.display="none");let s="";n.items.forEach((t=>{"youtube#video"===t.id.kind&&(s+=`\n            <div class="video-card" data-id="${t.id.videoId}">\n              <img src="${t.snippet.thumbnails.high.url}" alt="${t.snippet.title}">\n              <p>${t.snippet.title}</p>\n            </div>\n          `)})),a.insertAdjacentHTML("beforeend",s),document.querySelectorAll(".video-card").forEach((t=>{t.onclick=()=>{const e=t.getAttribute("data-id"),n=document.getElementById("videoPlayer"),o=document.getElementById("videoModal");n&&o&&(n.src=`https://www.youtube.com/embed/${e}?autoplay=1`,o.style.display="flex")}})),nextPageToken=n.nextPageToken||null;const l=document.getElementById("showMoreBtn");l&&(l.style.display=nextPageToken?"block":"none")}catch(t){const e=document.getElementById("youtube-section");e&&(e.style.display="none")}}function setupShowMoreButton(){const t=document.getElementById("showMoreBtn");t&&(t.onclick=function(){nextPageToken&&fetchYouTubeVideos(nextPageToken)})}function setupAdvertiseForm(){const t=el("#advForm");t&&t.addEventListener("submit",(t=>{t.preventDefault();const e=new FormData(t.target);e.get("brand"),e.get("email"),e.get("brief");window.open("https://www.instagram.com/direct/t/17843742567536413","_blank")}))}function setupFAQ(){const t=elAll(".faq-question");t.forEach((e=>{e.addEventListener("click",(()=>{const n=e.nextElementSibling,o=e.classList.contains("active");t.forEach((t=>{t.classList.remove("active"),t.nextElementSibling.classList.remove("active")})),o||(e.classList.add("active"),n.classList.add("active"))}))}))}function setupShareButton(){const t=el("#shareBtn");t&&t.addEventListener("click",(async()=>{const t={title:"DEKUTCONNECT — Campus media",text:"Check out DEKUTCONNECT — Where DeKUT vibes live",url:location.origin+location.pathname+"?showGroups=true"};if(navigator.share)try{await navigator.share(t)}catch(t){}else prompt("Share this link",t.url)}))}function optimizePerformance(){document.querySelectorAll("img").forEach((t=>t.setAttribute("loading","lazy"))),["https://www.googleapis.com","https://api.telegram.org","https://api.giftedtech.web.id"].forEach((t=>{const e=document.createElement("link");e.rel="preconnect",e.href=t,document.head.appendChild(e)}))}document.addEventListener("DOMContentLoaded",(()=>{setupBottomSheets(),setupModals(),setupAppInstall(),setupShowMoreButton(),setupAdvertiseForm(),setupShareButton(),setupFAQ(),optimizePerformance(),fetchYouTubeVideos();handleGroupModalFromUrl();document.title="DEKUTCONNECT — Where DeKUT Vibes Live"}));